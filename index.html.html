
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WA Roadtrip ‚Äì Too Broke to Get a Private Jet</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
    crossorigin=""
  />
  <style>
    :root {
      --bg-dark: #050814;
      --bg-panel: #0d1020;
      --accent: #4f7dff;
      --accent-soft: rgba(79, 125, 255, 0.15);
      --text-main: #f5f7ff;
      --text-muted: #9aa3c7;
      --border-soft: rgba(255, 255, 255, 0.06);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
    }

    body {
      background: radial-gradient(circle at top, #111633 0, #050814 55%);
      color: var(--text-main);
      height: 100vh;
      overflow: hidden;
      display: flex;
      align-items: stretch;
      justify-content: stretch;
    }

    #app-container {
      display: grid;
      grid-template-columns: minmax(280px, 360px) minmax(0, 1fr);
      width: 100%;
      height: 100%;
    }

    /* Sidebar */
    #sidebar {
      background: linear-gradient(160deg, #050814 0, #050814 45%, #111633 100%);
      border-right: 1px solid var(--border-soft);
      padding: 16px 14px 18px;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .app-title {
      font-size: 17px;
      font-weight: 600;
      letter-spacing: 0.02em;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .app-subtitle {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.18em;
      color: var(--text-muted);
    }

    .tagline-badge {
      margin-top: 6px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      padding: 4px 9px;
      border-radius: 999px;
      background: rgba(247, 250, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.08);
      color: var(--text-muted);
    }

    .tagline-badge span.icon {
      font-size: 12px;
    }

    /* Route selector buttons */
    .route-tabs {
      display: flex;
      gap: 6px;
      margin-top: 8px;
      padding: 4px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.02);
      border: 1px solid var(--border-soft);
    }

    .route-tab {
      flex: 1;
      border-radius: 999px;
      font-size: 11px;
      padding: 5px 6px;
      border: none;
      cursor: pointer;
      background: transparent;
      color: var(--text-muted);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .route-tab.active {
      background: var(--accent-soft);
      color: #f5f7ff;
      font-weight: 500;
    }

    .section-label {
      margin-top: 8px;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--text-muted);
    }

    .how-to {
      margin-top: 4px;
      padding: 9px 9px 9px 11px;
      border-radius: 12px;
      background: rgba(12, 17, 40, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-shadow: 0 14px 40px rgba(0, 0, 0, 0.45);
    }

    .how-to ul {
      padding-left: 16px;
      margin-top: 6px;
    }

    .how-to li {
      font-size: 11px;
      color: var(--text-muted);
      line-height: 1.5;
      margin-bottom: 2px;
    }

    .how-to strong {
      color: var(--text-main);
    }

    /* Day-by-day schedule */
    .schedule-card {
      margin-top: 6px;
      padding: 9px 10px;
      border-radius: 12px;
      background: rgba(10, 14, 35, 0.9);
      border: 1px solid rgba(255, 255, 255, 0.05);
      max-height: 190px;
      overflow-y: auto;
      scrollbar-width: thin;
    }

    .schedule-card h4 {
      font-size: 12px;
      margin-bottom: 4px;
      font-weight: 600;
    }

    .schedule-card p {
      font-size: 11px;
      color: var(--text-muted);
      margin-bottom: 2px;
    }

    .schedule-card span.date {
      font-weight: 500;
      color: #f5f7ff;
    }

    .schedule-card::-webkit-scrollbar {
      width: 5px;
    }

    .schedule-card::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.18);
      border-radius: 999px;
    }

    /* Main legs list */
    .legs-list {
      margin-top: 4px;
      padding: 9px 9px 8px;
      border-radius: 12px;
      background: rgba(8, 11, 28, 0.96);
      border: 1px solid rgba(255, 255, 255, 0.06);
      flex: 1;
      overflow-y: auto;
      scrollbar-width: thin;
    }

    .legs-list::-webkit-scrollbar {
      width: 4px;
    }

    .legs-list::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 999px;
    }

    .leg-item {
      padding: 7px 8px;
      border-radius: 10px;
      border: 1px solid rgba(255, 255, 255, 0.04);
      background: radial-gradient(circle at top left, rgba(79, 125, 255, 0.18), transparent 52%);
      margin-bottom: 5px;
    }

    .leg-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 4px;
      margin-bottom: 2px;
    }

    .leg-main {
      font-size: 11px;
      font-weight: 600;
    }

    .leg-time {
      font-size: 11px;
      color: #d9e1ff;
      white-space: nowrap;
    }

    .leg-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      margin-top: 2px;
    }

    .leg-tag {
      font-size: 10px;
      padding: 2px 6px;
      border-radius: 999px;
      background: rgba(15, 85, 255, 0.12);
      color: #c6d2ff;
    }

    .leg-link {
      display: inline-block;
      margin-top: 2px;
      font-size: 10px;
      color: #8fb1ff;
      text-decoration: none;
    }

    .leg-link:hover {
      text-decoration: underline;
    }

    .footer-note {
      margin-top: 4px;
      font-size: 10px;
      color: var(--text-muted);
    }

    /* Map */
    #map-container {
      position: relative;
      width: 100%;
      height: 100%;
    }

    #map {
      height: 100%;
      width: 100%;
    }

    .map-title-overlay {
      position: absolute;
      top: 14px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(5, 8, 20, 0.88);
      border-radius: 999px;
      padding: 6px 14px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.5);
      font-size: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      z-index: 900;
      pointer-events: none;
    }

    .map-title-overlay span.icon {
      font-size: 14px;
    }

    .leaflet-tooltip.route-label {
      background: rgba(5, 8, 20, 0.82);
      border: 1px solid rgba(255, 255, 255, 0.3);
      color: #f5f7ff;
      font-size: 10px;
      padding: 3px 6px;
      border-radius: 999px;
    }

    .leaflet-popup-content-wrapper {
      background: #050814;
      color: var(--text-main);
    }

    .leaflet-popup-tip {
      background: #050814;
    }

    .popup-title {
      font-weight: 600;
      margin-bottom: 4px;
      font-size: 12px;
    }

    .popup-body {
      font-size: 11px;
      color: var(--text-muted);
    }

    .popup-body a {
      color: #8fb1ff;
    }

    @media (max-width: 820px) {
      #app-container {
        grid-template-columns: 100%;
        grid-template-rows: minmax(260px, 360px) minmax(0, 1fr);
      }
      #sidebar {
        border-right: none;
        border-bottom: 1px solid var(--border-soft);
      }
      .schedule-card {
        max-height: 130px;
      }
      .map-title-overlay {
        top: 8px;
      }
    }
  </style>
</head>
<body>
  <div id="app-container">
    <aside id="sidebar">
      <div class="app-title">
        <span class="app-subtitle">wa south coast ‚Ä¢ 26 dec ‚Äì 4 jan</span>
        WA Roadtrip Planner
        <div class="tagline-badge">
          <span class="icon">‚úàÔ∏è</span>
          <span id="tagline-text">Too broke to get a private jet ‚Äì so we drive smarter.</span>
        </div>
      </div>

      <div class="route-tabs">
        <button class="route-tab active" data-route="MASTER">Master</button>
        <button class="route-tab" data-route="A">Option A</button>
        <button class="route-tab" data-route="B">Option B</button>
        <button class="route-tab" data-route="C">Option C</button>
        <button class="route-tab" data-route="D">Option D</button>
      </div>

      <div class="section-label">How to use this map</div>
      <div class="how-to" id="how-to-block">
        <ul>
          <li><strong>Click a route option</strong> above to switch itineraries.</li>
          <li><strong>Tap lines & dots</strong> on the map for quick info & links.</li>
          <li><strong>Drag + pinch</strong> to explore coastlines, forests & towns.</li>
          <li><strong>Use your phone</strong> in landscape for best experience.</li>
        </ul>
      </div>

      <div class="section-label">Day-by-day for 26 Dec ‚Äì 4 Jan</div>
      <div class="schedule-card" id="schedule-card">
        <!-- Filled by JS -->
      </div>

      <div class="section-label">Main legs & what they offer</div>
      <div class="legs-list" id="legs-list">
        <!-- Filled by JS -->
      </div>

      <div class="footer-note">
        Tip: Once you're happy with one option, you can recreate it in Google
        Maps for turn-by-turn nav. This view is mainly for planning & vibes.
      </div>
    </aside>

    <main id="map-container">
      <div class="map-title-overlay">
        <span class="icon">üó∫Ô∏è</span>
        <span id="map-title">Master View ‚Äì South-West Core Route</span>
      </div>
      <div id="map"></div>
    </main>
  </div>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""
  ></script>
  <script>
    const places = {
      "Perth": { lat: -31.9559, lng: 115.8606, link: "https://www.google.com/maps/search/?api=1&query=Perth+WA" },
      "Busselton": { lat: -33.6508, lng: 115.3469, link: "https://www.google.com/maps/place/Busselton+Jetty" },
      "Dunsborough": { lat: -33.6148, lng: 115.1045, link: "https://www.google.com/maps/search/?api=1&query=Dunsborough+WA" },
      "Yallingup": { lat: -33.6464, lng: 115.0339, link: "https://www.google.com/maps/search/?api=1&query=Yallingup+WA" },
      "Margaret River": { lat: -33.9536, lng: 115.0730, link: "https://www.google.com/maps/search/?api=1&query=Margaret+River+WA" },
      "Pemberton": { lat: -34.4400, lng: 116.0500, link: "https://www.google.com/maps/search/?api=1&query=Pemberton+Karri+Forest" },
      "Walpole": { lat: -34.9780, lng: 116.7330, link: "https://www.google.com/maps/search/?api=1&query=Walpole+Tree+Top+Walk" },
      "Denmark": { lat: -34.9619, lng: 117.3562, link: "https://www.google.com/maps/search/?api=1&query=Denmark+WA" },
      "Greens Pool": { lat: -35.0212, lng: 117.2343, link: "https://www.google.com/maps/place/Greens+Pool" },
      "Elephant Rocks": { lat: -35.0261, lng: 117.2373, link: "https://www.google.com/maps/place/Elephant+Rocks" },
      "Albany": { lat: -35.0228, lng: 117.8814, link: "https://www.google.com/maps/search/?api=1&query=Albany+WA" },
      "The Gap": { lat: -35.1186, lng: 117.8925, link: "https://www.google.com/maps/place/The+Gap+and+Natural+Bridge" },
      "Esperance": { lat: -33.8610, lng: 121.8920, link: "https://www.google.com/maps/search/?api=1&query=Esperance+WA" },
      "Lucky Bay": { lat: -33.9944, lng: 122.2325, link: "https://www.google.com/maps/place/Lucky+Bay+Campground" },
      "Hyden / Wave Rock": { lat: -32.4500, lng: 118.8833, link: "https://www.google.com/maps/place/Wave+Rock" }
    };

    const routes = {
      MASTER: {
        title: "Master View ‚Äì South-West Core Route",
        tagline: "Overview of the south-west spine you'll keep returning to.",
        schedule: [
          "25 Dec ‚Äì Arrive Perth late, sleep.",
          "26 Dec ‚Äì Perth city & Kings Park; pick up car.",
          "27‚Äì30 Dec ‚Äì Use options A‚ÄìD to choose where you base yourself.",
          "31 Dec ‚Äì Back in Perth for NYE fireworks on the Swan River.",
          "1‚Äì3 Jan ‚Äì Perth / Fremantle / Rottnest / recovery days.",
          "4 Jan ‚Äì Last coffees, airport at night."
        ],
        legs: [
          { from: "Perth", to: "Busselton", dist: "220 km", time: "‚âà2.5 h", tags: ["Coastal drive", "Jetty walk"], link: "https://www.google.com/maps/dir/Perth+WA/Busselton+WA" },
          { from: "Busselton", to: "Dunsborough", dist: "24 km", time: "‚âà25 min", tags: ["Calm coves"], link: "https://www.google.com/maps/dir/Busselton+WA/Dunsborough+WA" },
          { from: "Dunsborough", to: "Yallingup", dist: "10 km", time: "‚âà10 min", tags: ["Surf coast"], link: "https://www.google.com/maps/dir/Dunsborough+WA/Yallingup+WA" },
          { from: "Yallingup", to: "Margaret River", dist: "40 km", time: "‚âà40 min", tags: ["Wineries", "Caves"], link: "https://www.google.com/maps/dir/Yallingup+WA/Margaret+River+WA" },
          { from: "Margaret River", to: "Pemberton", dist: "135 km", time: "‚âà1.8 h", tags: ["Karri forests"], link: "https://www.google.com/maps/dir/Margaret+River+WA/Pemberton+WA" },
          { from: "Pemberton", to: "Walpole", dist: "120 km", time: "‚âà1.5 h", tags: ["Tree-top walks"], link: "https://www.google.com/maps/dir/Pemberton+WA/Walpole+WA" },
          { from: "Walpole", to: "Denmark", dist: "66 km", time: "‚âà50 min", tags: ["Inlets"], link: "https://www.google.com/maps/dir/Walpole+WA/Denmark+WA" },
          { from: "Denmark", to: "Albany", dist: "54 km", time: "‚âà45 min", tags: ["Coastal lookouts"], link: "https://www.google.com/maps/dir/Denmark+WA/Albany+WA" }
        ]
      },
      A: {
        title: "Option A ‚Äì Classic South-West Loop (Chill, No Esperance)",
        tagline: "Best balance of beaches, wine, forests & time in Perth.",
        schedule: [
          "25 Dec ‚Äì Arrive Perth late, sleep.",
          "26 Dec ‚Äì Perth city warm-up + Kings Park sunset.",
          "27 Dec ‚Äì Perth ‚Üí Busselton / Dunsborough base.",
          "28 Dec ‚Äì Yallingup & Margaret River day (wineries, caves).",
          "29 Dec ‚Äì Drive via Pemberton forests to Walpole / Denmark.",
          "30 Dec ‚Äì Explore Denmark & Albany, then drive back to Perth.",
          "31 Dec ‚Äì Perth & Fremantle + NYE fireworks on Swan River.",
          "1‚Äì3 Jan ‚Äì Day trips: Rottnest Island / Cottesloe / Swan Valley.",
          "4 Jan ‚Äì Final coffee, last-minute shopping, airport at night."
        ],
        legs: [
          { from: "Perth", to: "Busselton", dist: "220 km", time: "‚âà2.5 h", tags: ["Jetty", "Swim beach"], link: "https://www.google.com/maps/dir/Perth+WA/Busselton+WA" },
          { from: "Busselton", to: "Dunsborough", dist: "24 km", time: "‚âà25 min", tags: ["Bays", "Caf√©s"], link: "https://www.google.com/maps/dir/Busselton+WA/Dunsborough+WA" },
          { from: "Dunsborough", to: "Yallingup", dist: "10 km", time: "‚âà10 min", tags: ["Surf", "Lookouts"], link: "https://www.google.com/maps/dir/Dunsborough+WA/Yallingup+WA" },
          { from: "Yallingup", to: "Margaret River", dist: "40 km", time: "‚âà40 min", tags: ["Wineries", "Caves"], link: "https://www.google.com/maps/dir/Yallingup+WA/Margaret+River+WA" },
          { from: "Margaret River", to: "Pemberton", dist: "135 km", time: "‚âà1.8 h", tags: ["Tall trees"], link: "https://www.google.com/maps/dir/Margaret+River+WA/Pemberton+WA" },
          { from: "Pemberton", to: "Walpole", dist: "120 km", time: "‚âà1.5 h", tags: ["Tree-top walk"], link: "https://www.google.com/maps/dir/Pemberton+WA/Walpole+WA" },
          { from: "Walpole", to: "Denmark", dist: "66 km", time: "‚âà50 min", tags: ["Inlet views"], link: "https://www.google.com/maps/dir/Walpole+WA/Denmark+WA" },
          { from: "Denmark", to: "Albany", dist: "54 km", time: "‚âà45 min", tags: ["Torndirrup NP"], link: "https://www.google.com/maps/dir/Denmark+WA/Albany+WA" },
          { from: "Albany", to: "Perth", dist: "420 km", time: "‚âà4.5‚Äì5 h", tags: ["Inland return"], link: "https://www.google.com/maps/dir/Albany+WA/Perth+WA" }
        ]
      },
      B: {
        title: "Option B ‚Äì Albany + Esperance + Wave Rock Loop",
        tagline: "Chase the white beaches & pink-ish lakes, accept big drives.",
        schedule: [
          "25 Dec ‚Äì Arrive Perth late, sleep.",
          "26 Dec ‚Äì Perth ‚Üí Albany (settle in, sunset at The Gap).",
          "27 Dec ‚Äì Albany ‚Üí Esperance via coastal route (big drive).",
          "28 Dec ‚Äì Esperance & Lucky Bay (beaches, sand, drone shots).",
          "29 Dec ‚Äì Esperance ‚Üí Hyden / Wave Rock (inland change of scenery).",
          "30 Dec ‚Äì Hyden ‚Üí Perth by afternoon, reset for NYE.",
          "31 Dec ‚Äì Perth CBD / Kings Park & NYE fireworks.",
          "1‚Äì3 Jan ‚Äì Freo, Cottesloe, Rottnest or Swan Valley day trips.",
          "4 Jan ‚Äì Pack, brunch, airport at night."
        ],
        legs: [
          { from: "Perth", to: "Albany", dist: "420 km", time: "‚âà4.5‚Äì5 h", tags: ["Inland", "Country towns"], link: "https://www.google.com/maps/dir/Perth+WA/Albany+WA" },
          { from: "Albany", to: "Esperance", dist: "485 km", time: "‚âà5 h", tags: ["Long coastal run"], link: "https://www.google.com/maps/dir/Albany+WA/Esperance+WA" },
          { from: "Esperance", to: "Hyden / Wave Rock", dist: "380 km", time: "‚âà4‚Äì4.5 h", tags: ["Wheatbelt landscapes"], link: "https://www.google.com/maps/dir/Esperance+WA/Wave+Rock" },
          { from: "Hyden / Wave Rock", to: "Perth", dist: "330 km", time: "‚âà4 h", tags: ["Inland return"], link: "https://www.google.com/maps/dir/Wave+Rock/Perth+WA" }
        ]
      },
      C: {
        title: "Option C ‚Äì Big Loop: South-West + Esperance + Wave Rock",
        tagline: "Maximum FOMO cure. Minimum chill. Huge but doable if shared driving.",
        schedule: [
          "25 Dec ‚Äì Arrive Perth late, sleep.",
          "26 Dec ‚Äì Perth ‚Üí Busselton / Dunsborough (jetty, swim, chill).",
          "27 Dec ‚Äì Yallingup & Margaret River day, stay in Margs.",
          "28 Dec ‚Äì Margs ‚Üí Pemberton ‚Üí Walpole / Denmark.",
          "29 Dec ‚Äì Denmark ‚Üí Albany ‚Üí continue to Esperance (monster day).",
          "30 Dec ‚Äì Esperance & Lucky Bay + coastal lookouts.",
          "31 Dec ‚Äì Esperance ‚Üí Hyden ‚Üí Perth for NYE fireworks (very long day).",
          "1‚Äì3 Jan ‚Äì Stay Perth/Freo/Rottnest only (zero more driving).",
          "4 Jan ‚Äì Airport at night."
        ],
        legs: [
          { from: "Perth", to: "Busselton", dist: "220 km", time: "‚âà2.5 h", tags: ["Jetty"], link: "https://www.google.com/maps/dir/Perth+WA/Busselton+WA" },
          { from: "Busselton", to: "Margaret River", dist: "50 km", time: "‚âà45 min", tags: ["Wineries"], link: "https://www.google.com/maps/dir/Busselton+WA/Margaret+River+WA" },
          { from: "Margaret River", to: "Pemberton", dist: "135 km", time: "‚âà1.8 h", tags: ["Forests"], link: "https://www.google.com/maps/dir/Margaret+River+WA/Pemberton+WA" },
          { from: "Pemberton", to: "Walpole", dist: "120 km", time: "‚âà1.5 h", tags: ["Tree-top walk"], link: "https://www.google.com/maps/dir/Pemberton+WA/Walpole+WA" },
          { from: "Walpole", to: "Denmark", dist: "66 km", time: "‚âà50 min", tags: ["Inlets"], link: "https://www.google.com/maps/dir/Walpole+WA/Denmark+WA" },
          { from: "Denmark", to: "Albany", dist: "54 km", time: "‚âà45 min", tags: ["National park"], link: "https://www.google.com/maps/dir/Denmark+WA/Albany+WA" },
          { from: "Albany", to: "Esperance", dist: "485 km", time: "‚âà5 h", tags: ["Remote coast"], link: "https://www.google.com/maps/dir/Albany+WA/Esperance+WA" },
          { from: "Esperance", to: "Hyden / Wave Rock", dist: "380 km", time: "‚âà4‚Äì4.5 h", tags: ["Wheatbelt"], link: "https://www.google.com/maps/dir/Esperance+WA/Wave+Rock" },
          { from: "Hyden / Wave Rock", to: "Perth", dist: "330 km", time: "‚âà4 h", tags: ["Return"], link: "https://www.google.com/maps/dir/Wave+Rock/Perth+WA" }
        ]
      },
      D: {
        title: "Option D ‚Äì Short & Chill South-West (More Time in Bases)",
        tagline: "Ideal if you want long coffees, swims & fewer check-outs.",
        schedule: [
          "25 Dec ‚Äì Arrive Perth late, sleep.",
          "26 Dec ‚Äì Perth city & Kings Park, stay Perth.",
          "27 Dec ‚Äì Perth ‚Üí Busselton / Dunsborough (3 nights base).",
          "28 Dec ‚Äì Yallingup & Margaret River loop, return to same base.",
          "29 Dec ‚Äì Optional second Margs / Hamelin Bay / Eagle Bay day.",
          "30 Dec ‚Äì Drive Busselton ‚Üí Albany (longer push), stay 2 nights.",
          "31 Dec ‚Äì Either stay Albany or return to Perth for NYE fireworks.",
          "1‚Äì3 Jan ‚Äì Perth / Fremantle / Rottnest / Swan Valley.",
          "4 Jan ‚Äì Airport at night."
        ],
        legs: [
          { from: "Perth", to: "Busselton", dist: "220 km", time: "‚âà2.5 h", tags: ["Jetty", "Beach"], link: "https://www.google.com/maps/dir/Perth+WA/Busselton+WA" },
          { from: "Busselton", to: "Dunsborough", dist: "24 km", time: "‚âà25 min", tags: ["Calm bays"], link: "https://www.google.com/maps/dir/Busselton+WA/Dunsborough+WA" },
          { from: "Dunsborough", to: "Yallingup", dist: "10 km", time: "‚âà10 min", tags: ["Surf"], link: "https://www.google.com/maps/dir/Dunsborough+WA/Yallingup+WA" },
          { from: "Yallingup", to: "Margaret River", dist: "40 km", time: "‚âà40 min", tags: ["Wine", "Caves"], link: "https://www.google.com/maps/dir/Yallingup+WA/Margaret+River+WA" },
          { from: "Margaret River", to: "Albany", dist: "340 km", time: "‚âà4 h", tags: ["Forest & farmland"], link: "https://www.google.com/maps/dir/Margaret+River+WA/Albany+WA" },
          { from: "Albany", to: "Perth", dist: "420 km", time: "‚âà4.5‚Äì5 h", tags: ["Inland"], link: "https://www.google.com/maps/dir/Albany+WA/Perth+WA" }
        ]
      }
    };

    function getRouteLatLngs(routeCode) {
      const legs = routes[routeCode].legs;
      const coords = [];
      legs.forEach(leg => {
        if (!coords.length) coords.push([places[leg.from].lat, places[leg.from].lng]);
        coords.push([places[leg.to].lat, places[leg.to].lng]);
      });
      return coords;
    }

    const map = L.map("map", { center: [-33.4, 116.0], zoom: 6, zoomControl: true });

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 18,
      attribution: '&copy; <a href="https://www.openstreetmap.org/">OSM</a>'
    }).addTo(map);

    const routeLayerGroup = L.layerGroup().addTo(map);
    const markerLayerGroup = L.layerGroup().addTo(map);

    const mapTitleEl = document.getElementById("map-title");
    const taglineTextEl = document.getElementById("tagline-text");
    const scheduleCardEl = document.getElementById("schedule-card");
    const legsListEl = document.getElementById("legs-list");
    const routeTabEls = document.querySelectorAll(".route-tab");

    function renderSchedule(routeCode) {
      const sched = routes[routeCode].schedule;
      scheduleCardEl.innerHTML = "<h4>Suggested plan</h4>";
      sched.forEach(text => {
        const p = document.createElement("p");
        p.textContent = text;
        scheduleCardEl.appendChild(p);
      });
    }

    function renderLegs(routeCode) {
      const legs = routes[routeCode].legs;
      legsListEl.innerHTML = "";
      legs.forEach(leg => {
        const div = document.createElement("div");
        div.className = "leg-item";

        const header = document.createElement("div");
        header.className = "leg-header";

        const main = document.createElement("div");
        main.className = "leg-main";
        main.textContent = `${leg.from} ‚Üí ${leg.to}`;

        const time = document.createElement("div");
        time.className = "leg-time";
        time.textContent = `${leg.dist} ‚Ä¢ ${leg.time}`;

        header.appendChild(main);
        header.appendChild(time);
        div.appendChild(header);

        const tagsRow = document.createElement("div");
        tagsRow.className = "leg-tags";
        (leg.tags || []).forEach(tag => {
          const span = document.createElement("span");
          span.className = "leg-tag";
          span.textContent = tag;
          tagsRow.appendChild(span);
        });
        div.appendChild(tagsRow);

        if (leg.link) {
          const a = document.createElement("a");
          a.className = "leg-link";
          a.href = leg.link;
          a.target = "_blank";
          a.rel = "noopener";
          a.textContent = "Open this leg in Google Maps";
          div.appendChild(a);
        }

        legsListEl.appendChild(div);
      });
    }

    function styleForRoute(routeCode) {
      switch (routeCode) {
        case "A": return { color: "#4f7dff" };
        case "B": return { color: "#ff6b81" };
        case "C": return { color: "#ffc857" };
        case "D": return { color: "#3ddc97" };
        default: return { color: "#9fa6ff" };
      }
    }

    function showRoute(routeCode) {
      const cfg = routes[routeCode];
      routeLayerGroup.clearLayers();
      markerLayerGroup.clearLayers();

      const latLngs = getRouteLatLngs(routeCode);
      if (!latLngs.length) return;

      const style = styleForRoute(routeCode);
      const poly = L.polyline(latLngs, { color: style.color, weight: 4, opacity: 0.9 }).addTo(routeLayerGroup);

      routes[routeCode].legs.forEach(leg => {
        const start = places[leg.from];
        const end = places[leg.to];
        const midLat = (start.lat + end.lat) / 2;
        const midLng = (start.lng + end.lng) / 2;
        const tooltip = L.tooltip({
          permanent: true,
          direction: "center",
          className: "route-label"
        })
          .setLatLng([midLat, midLng])
          .setContent(`${leg.from} ‚Üí ${leg.to}<br>${leg.dist} ‚Ä¢ ${leg.time}`);
        routeLayerGroup.addLayer(tooltip);
      });

      const usedPlaces = new Set();
      routes[routeCode].legs.forEach(leg => {
        usedPlaces.add(leg.from);
        usedPlaces.add(leg.to);
      });

      usedPlaces.forEach(name => {
        const p = places[name];
        const marker = L.circleMarker([p.lat, p.lng], {
          radius: 6,
          color: style.color,
          weight: 2,
          fillColor: "#ffffff",
          fillOpacity: 0.9
        }).bindPopup(`
            <div class="popup-title">${name}</div>
            <div class="popup-body">
              <a href="${p.link}" target="_blank" rel="noopener">
                Open ${name} in Google Maps
              </a>
            </div>
          `);
        markerLayerGroup.addLayer(marker);
      });

      map.fitBounds(poly.getBounds(), { padding: [30, 30] });

      mapTitleEl.textContent = cfg.title;
      taglineTextEl.textContent = cfg.tagline;
      renderSchedule(routeCode);
      renderLegs(routeCode);

      routeTabEls.forEach(btn => {
        btn.classList.toggle("active", btn.dataset.route === routeCode);
      });
    }

    routeTabEls.forEach(btn => {
      btn.addEventListener("click", () => {
        const routeCode = btn.dataset.route;
        showRoute(routeCode);
      });
    });

    showRoute("MASTER");
  </script>
</body>
</html>
